<pre><font color="#007f69">extensions</font><font color="#000000"> [palette matrix nw table]<br /><br /></font><font color="#007f69">globals</font><font color="#000000"> [ coordinates1 species tree-set mate N Ni Nt1 Nt2 Nt3 Nt4 Nt5 Nt6 Nt7 Nt8 Nt9 Nt counter<br />          start? harvesting trimming fertilizing  soil-factor<br />          growth-rate-ilex  growth-rate-cana  growth-rate-an  growth-rate-la  growth-rate-pet  growth-rate-ar  growth-rate-gu<br />          growth-rate-toona  growth-rate-gr  growth-rate-ki<br />          growth-energy-uptake<br />          harvest-size         </font><font color="#5a5a5a">; Minimum size for harvesting</font><font color="#000000"><br />          tree-trim-size       </font><font color="#5a5a5a">; Minimum size for trimming</font><font color="#000000"><br />          tree-thin-size       </font><font color="#5a5a5a">; Minimum size for thinning</font><font color="#000000"><br />          harvest-rate         </font><font color="#5a5a5a">; Percentage of plant harvested</font><font color="#000000"><br />          harvest-amount       </font><font color="#5a5a5a">; Amount ilex plants are reduced as harvest</font><font color="#000000"><br />          total-harvest        </font><font color="#5a5a5a">; Total amount harvested over time</font><font color="#000000"><br />          minimum-viable-size  </font><font color="#5a5a5a">; Minimum size for a plant to be manipulated</font><font color="#000000"><br />          harvest-trees        </font><font color="#5a5a5a">; Amount trees are reduced as trimming which is a harvest</font><font color="#000000"><br />          thinned-amount       </font><font color="#5a5a5a">; Amount of tree mass reduced by thinning</font><font color="#000000"><br />          et soil-multiplier-mate soil-multiplier-trees species-multipliers  soil-multiplier-increment convert-dry convert-SOM buffer-factor fertilizer-amount<br />          thiniter1?  thiniter2? thinned-count soil-multiplier soil-gain countert1 last-rebalance  previous-soil-energy soil-energy-improvement]<br /><br /></font><font color="#660096">breed</font><font color="#000000"> [ species0 ilex ]             </font><font color="#5a5a5a">; ilex</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species1 Toona ]            </font><font color="#5a5a5a">; Toona</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species2 Cana ]             </font><font color="#5a5a5a">; Cañafístola</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species3 La ]               </font><font color="#5a5a5a">; Lapacho</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species4 Pet ]              </font><font color="#5a5a5a">; Petiribí</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species5 An ]               </font><font color="#5a5a5a">; Anchico</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species6 Ar ]               </font><font color="#5a5a5a">; Araucaria</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species7 Gu]                </font><font color="#5a5a5a">; Guatambú</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species8 Gr ]               </font><font color="#5a5a5a">; Grevillea</font><font color="#000000"><br /></font><font color="#660096">breed</font><font color="#000000"> [ species9 Ki ]               </font><font color="#5a5a5a">; Kiri</font><font color="#000000"><br /><br /></font><font color="#007f69">species0-own</font><font color="#000000"> [ energy-ilex ]<br /></font><font color="#007f69">species1-own</font><font color="#000000"> [ energy-Toona       soil-multiplier-Toona]<br /></font><font color="#007f69">species2-own</font><font color="#000000"> [ energy-Cañafístola soil-multiplier-Cañafístola]<br /></font><font color="#007f69">species3-own</font><font color="#000000"> [ energy-Lapacho     soil-multiplier-Lapacho]<br /></font><font color="#007f69">species4-own</font><font color="#000000"> [ energy-Petiribí    soil-multiplier-Petiribí]<br /></font><font color="#007f69">species5-own</font><font color="#000000"> [ energy-Anchico     soil-multiplier-Anchico]<br /></font><font color="#007f69">species6-own</font><font color="#000000"> [ energy-Araucaria   soil-multiplier-Araucaria]<br /></font><font color="#007f69">species7-own</font><font color="#000000"> [ energy-Guatambú    soil-multiplier-Guatambú]<br /></font><font color="#007f69">species8-own</font><font color="#000000"> [ energy-Grevillea   soil-multiplier-Grevillea]<br /></font><font color="#007f69">species9-own</font><font color="#000000"> [ energy-Kiri        soil-multiplier-Kiri]<br /></font><font color="#007f69">turtles-own</font><font color="#000000">  [ energy-trees ]<br /></font><font color="#007f69">patches-own</font><font color="#000000">  [ soil soil-energy  soil1 soil2 soil3 soil4 soil5 local-soil-factor]<br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">resize-world</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">210</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">210</font><font color="#000000"><br />  </font><font color="#0000aa">set-patch-size</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> tree-set []                                                 </font><font color="#5a5a5a">;; List of all trees</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> mate  []                                                    </font><font color="#5a5a5a">;; List of all ilex plants</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> species []                                                  </font><font color="#5a5a5a">;; List of all plants, ilex &amp; trees</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> start? </font><font color="#963700">true</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thiniter1? </font><font color="#963700">true</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thiniter2? </font><font color="#963700">false</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thinned-count </font><font color="#963700">0</font><font color="#000000"><br /><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvesting   [</font><font color="#963700">24</font><font color="#000000"> </font><font color="#963700">76</font><font color="#000000"> </font><font color="#963700">128</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"> </font><font color="#963700">232</font><font color="#000000"> </font><font color="#963700">284</font><font color="#000000"> </font><font color="#963700">336</font><font color="#000000"> </font><font color="#963700">388</font><font color="#000000"> </font><font color="#963700">440</font><font color="#000000"> </font><font color="#963700">492</font><font color="#000000"> </font><font color="#963700">544</font><font color="#000000">]    </font><font color="#5a5a5a">;; For efficiency, lists are given not computed; Harvest June 24</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> fertilizing  [</font><font color="#963700">40</font><font color="#000000"> </font><font color="#963700">92</font><font color="#000000"> </font><font color="#963700">144</font><font color="#000000"> </font><font color="#963700">196</font><font color="#000000"> </font><font color="#963700">248</font><font color="#000000"> </font><font color="#963700">300</font><font color="#000000"> </font><font color="#963700">352</font><font color="#000000"> </font><font color="#963700">404</font><font color="#000000"> </font><font color="#963700">456</font><font color="#000000"> </font><font color="#963700">508</font><font color="#000000"> </font><font color="#963700">560</font><font color="#000000">]    </font><font color="#5a5a5a">;; Fertilizing October 40</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> trimming     [</font><font color="#963700">36</font><font color="#000000"> </font><font color="#963700">88</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000"> </font><font color="#963700">192</font><font color="#000000"> </font><font color="#963700">244</font><font color="#000000"> </font><font color="#963700">296</font><font color="#000000"> </font><font color="#963700">348</font><font color="#000000"> </font><font color="#963700">400</font><font color="#000000"> </font><font color="#963700">452</font><font color="#000000"> </font><font color="#963700">504</font><font color="#000000"> </font><font color="#963700">556</font><font color="#000000">]    </font><font color="#5a5a5a">;; Trimming trees from September year 1 36</font><font color="#000000"><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">  [<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil fertility                                              </font><font color="#5a5a5a">;; the terrain (patches) variable soil takes the value of the chosen soil fertility starting point</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">10000</font><font color="#000000">                     </font><font color="#5a5a5a">;; colors represent the starting soil fertility, chosen by the user, which is stored in soil types 1 to 5</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">49</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil1 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">39</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil2 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">29</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil3 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> fertility </font><font color="#660096">and</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">19</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil4 fertility ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> fertility </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000">  [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">  </font><font color="#963700">139</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> soil5 fertility ]<br />   ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-ilex  </font><font color="#963700">0.22</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-toona </font><font color="#963700">0.64</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-cana  </font><font color="#963700">0.33</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-la    </font><font color="#963700">0.49</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-pet   </font><font color="#963700">0.44</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-an    </font><font color="#963700">0.32</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-ar    </font><font color="#963700">0.25</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-gu    </font><font color="#963700">0.56</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-gr    </font><font color="#963700">0.35</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-pet   </font><font color="#963700">0.44</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-rate-ki    </font><font color="#963700">0.54</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-energy-uptake </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-mate </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> species-multipliers table:make<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-increment </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-energy-improvement </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> convert-dry  </font><font color="#963700">0.12</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> convert-SOM  </font><font color="#963700">0.3</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> buffer-factor </font><font color="#963700">0.12</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> fertilizer-amount </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-gain </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> countert1 </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> last-rebalance </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> previous-soil-energy </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-size </font><font color="#963700">2.5</font><font color="#000000">                                            </font><font color="#5a5a5a">;; only harvest plants size 2.5 or larger</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> tree-trim-size </font><font color="#963700">3.2</font><font color="#000000">                                          </font><font color="#5a5a5a">;; only trim trees size 3.2 or larger</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> tree-thin-size </font><font color="#963700">9</font><font color="#000000">                                            </font><font color="#5a5a5a">;; only thin trees size 9 or larger</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-rate harvest-intensity </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">                        </font><font color="#5a5a5a">;; Harvest 34% of the plant</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> total-harvest </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-amount []<br />  </font><font color="#0000aa">set</font><font color="#000000"> minimum-viable-size </font><font color="#963700">0.25</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> harvest-trees </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> thinned-amount </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor </font><font color="#963700">1</font><font color="#000000"> ]<br /><br />  </font><font color="#0000aa">let</font><font color="#000000">  n1 </font><font color="#963700">0</font><font color="#000000">                                                       </font><font color="#5a5a5a">;; create the initial array of Species0, ilex plants, mate</font><font color="#000000"><br />   </font><font color="#0000aa">while</font><font color="#000000"> [ n1 </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">]<br />         [</font><font color="#0000aa">let</font><font color="#000000"> n2 </font><font color="#963700">0</font><font color="#000000"><br />          </font><font color="#0000aa">while</font><font color="#000000"> [n2 </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">]<br />            [</font><font color="#0000aa">let</font><font color="#000000"> x n1 </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />             </font><font color="#0000aa">let</font><font color="#000000"> y n2 </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />             create-species0  </font><font color="#963700">1</font><font color="#000000"> [<br />                </font><font color="#0000aa">setxy</font><font color="#000000">  x  y<br />                </font><font color="#0000aa">set</font><font color="#000000"> mate </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> mate<br />                </font><font color="#0000aa">set</font><font color="#000000"> species </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species<br />              ]<br />         </font><font color="#0000aa">set</font><font color="#000000"> n2 n2 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />           ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> n1 n1 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />         ]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;plant&quot;</font><font color="#000000">]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">66</font><font color="#000000">]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">]<br />    </font><font color="#0000aa">set</font><font color="#000000"> Ni  </font><font color="#660096">count</font><font color="#000000"> species0                                        </font><font color="#5a5a5a">;; Ni is the counter for the number of mate plants, number ilex</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;number ilex&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">show</font><font color="#000000"> Ni<br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;list ilex plants&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">show</font><font color="#000000"> mate<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> species-data [                                              </font><font color="#5a5a5a">;; each species will be placed at a determined x and y offsetset coordinates, with a color</font><font color="#000000"><br />    [</font><font color="#963700">&quot;species1&quot;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">    </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">53</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species2&quot;</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">55</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species3&quot;</font><font color="#000000"> </font><font color="#963700">40</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">57</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species4&quot;</font><font color="#000000"> </font><font color="#963700">60</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">63</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species5&quot;</font><font color="#000000"> </font><font color="#963700">80</font><font color="#000000">   </font><font color="#963700">0</font><font color="#000000">  </font><font color="#963700">67</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species6&quot;</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">43</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species7&quot;</font><font color="#000000"> </font><font color="#963700">120</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species8&quot;</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">77</font><font color="#000000">]<br />    [</font><font color="#963700">&quot;species9&quot;</font><font color="#000000"> </font><font color="#963700">160</font><font color="#000000">  </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">74</font><font color="#000000">]<br />  ]<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> species-data [ data -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> breed-name </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> data<br />    </font><font color="#0000aa">let</font><font color="#000000"> start-x </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> data<br />    </font><font color="#0000aa">let</font><font color="#000000"> start-y </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> data<br />    </font><font color="#0000aa">let</font><font color="#000000"> colour  </font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> data<br />    create-species breed-name start-x start-y colour<br />    create-species breed-name (start-x </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) start-y colour<br />  ]<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set Nt&quot;</font><font color="#000000"> i </font><font color="#963700">&quot; count species&quot;</font><font color="#000000"> (i))<br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> Nt (Nt1 </font><font color="#660096">+</font><font color="#000000"> Nt2 </font><font color="#660096">+</font><font color="#000000"> Nt3 </font><font color="#660096">+</font><font color="#000000"> Nt4 </font><font color="#660096">+</font><font color="#000000"> Nt5 </font><font color="#660096">+</font><font color="#000000"> Nt6 </font><font color="#660096">+</font><font color="#000000"> Nt7 </font><font color="#660096">+</font><font color="#000000"> Nt8 </font><font color="#660096">+</font><font color="#000000"> Nt9)    </font><font color="#5a5a5a">;; Nt is the counter for the number of all trees of all species</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;number trees&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">show</font><font color="#000000"> Nt<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;list tree set&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">show</font><font color="#000000"> tree-set<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;list of species&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">show</font><font color="#000000"> species<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> create-species [breed-name start-x start-y colour]<br />  </font><font color="#0000aa">let</font><font color="#000000"> coordinates (</font><font color="#660096">n-values</font><font color="#000000"> </font><font color="#963700">21</font><font color="#000000"> [i -&gt; </font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> (</font><font color="#963700">5</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> i </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)])<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> coordinates [ xy -&gt;<br />    </font><font color="#0000aa">create-turtles</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">runresult</font><font color="#000000"> breed-name<br />      </font><font color="#0000aa">setxy</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> xy </font><font color="#660096">+</font><font color="#000000"> start-x) (</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> xy </font><font color="#660096">+</font><font color="#000000"> start-y)<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;tree&quot;</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> colour<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> tree-set </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> tree-set<br />      </font><font color="#0000aa">set</font><font color="#000000"> species </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#660096">self</font><font color="#000000"> species<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> get-species [k]<br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> k)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> get-growth-rate [k]<br />  </font><font color="#0000aa">let</font><font color="#000000"> species-names [</font><font color="#963700">&quot;ilex&quot;</font><font color="#000000"> </font><font color="#963700">&quot;toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;cana&quot;</font><font color="#000000"> </font><font color="#963700">&quot;la&quot;</font><font color="#000000"> </font><font color="#963700">&quot;pet&quot;</font><font color="#000000"> </font><font color="#963700">&quot;an&quot;</font><font color="#000000"> </font><font color="#963700">&quot;ar&quot;</font><font color="#000000"> </font><font color="#963700">&quot;gu&quot;</font><font color="#000000"> </font><font color="#963700">&quot;gr&quot;</font><font color="#000000"> </font><font color="#963700">&quot;ki&quot;</font><font color="#000000">]<br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;growth-rate-&quot;</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> k species-names))<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />    time-account<br />    </font><font color="#0000aa">if</font><font color="#000000"> idlabel? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000"> [idLabel]<br />    </font><font color="#0000aa">if</font><font color="#000000"> network? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000"> [create-network]<br />    </font><font color="#0000aa">if</font><font color="#000000"> matrix </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;nnMatrix&quot;</font><font color="#000000"> [export-nnMatrix]<br />    </font><font color="#0000aa">if</font><font color="#000000"> matrix </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;adjacency-matrix&quot;</font><font color="#000000">  [network-matrix]<br /><br />    nodeData<br />    linkData<br />    set-soil-factor<br />    energy-account<br />    </font><font color="#0000aa">if</font><font color="#000000">  </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">16</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [grow]<br />    </font><font color="#0000aa">if</font><font color="#000000">  </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [rebalance-soil]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;\nSoil Multiplier Status:&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> soil-multiplier-sources<br />    ]<br />    </font><font color="#0000aa">foreach</font><font color="#000000"> harvesting  [ x -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> x [harvest-ilex]]<br />    </font><font color="#0000aa">foreach</font><font color="#000000"> fertilizing  [ x -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> x [fertilize]]<br />    </font><font color="#0000aa">foreach</font><font color="#000000"> trimming    [ x -&gt; </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> x [trim-trees]]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000">] [thinning1]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> countert1 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">78</font><font color="#000000"> [thinning2]<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">16</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [compete-shade]<br />    </font><font color="#0000aa">if</font><font color="#000000">  </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mod</font><font color="#000000"> </font><font color="#963700">26</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [decay-local-soil-factor]<br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> species0 [die-ilex]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> species1 [die-tree]<br />    </font><font color="#0000aa">tick</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">520</font><font color="#000000"> [ </font><font color="#0000aa">stop</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> time-account<br />  </font><font color="#0000aa">set</font><font color="#000000"> counter counter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> idLabel<br />    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> create-network                                                          </font><font color="#5a5a5a">;; Define lists for species breeds and their corresponding link colors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-list (</font><font color="#660096">list</font><font color="#000000"> species1 species2 species3 species4 species5 species6 species7 species8 species9)<br />  </font><font color="#0000aa">let</font><font color="#000000"> colors-list (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">53</font><font color="#000000"> </font><font color="#963700">55</font><font color="#000000"> </font><font color="#963700">57</font><font color="#000000"> </font><font color="#963700">63</font><font color="#000000"> </font><font color="#963700">67</font><font color="#000000"> </font><font color="#963700">43</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000"> </font><font color="#963700">77</font><font color="#000000"> </font><font color="#963700">74</font><font color="#000000">)                        </font><font color="#5a5a5a">;; Corresponding colors for links</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-colors (</font><font color="#660096">map</font><font color="#000000"> </font><font color="#660096">list</font><font color="#000000"> tree-list colors-list)                         </font><font color="#5a5a5a">;; Combine species and colors into pairs</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> tree-colors [ pair -&gt;<br />      </font><font color="#0000aa">let</font><font color="#000000"> sp </font><font color="#660096">first</font><font color="#000000"> pair<br />      </font><font color="#0000aa">let</font><font color="#000000"> colour </font><font color="#660096">last</font><font color="#000000"> pair<br />      </font><font color="#0000aa">ask</font><font color="#000000"> species0 [                                                       </font><font color="#5a5a5a">;; Find the minimum distance to any turtle of the current species</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> min-dist </font><font color="#660096">min</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> sp                             </font><font color="#5a5a5a">;; Find all turtles of the current species at this minimum distance</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> closest-tree sp </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> min-dist]                </font><font color="#5a5a5a">;; Create a link with the closest turtles if within threshold distance</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> closest-tree [<br />        </font><font color="#0000aa">if</font><font color="#000000"> min-dist </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">7.1</font><font color="#000000"> [<br />          </font><font color="#0000aa">create-link-with</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000"> [<br />            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> colour<br />                     ]<br />                 ]<br />             ]<br />         ]<br />     ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> export-nnMatrix<br /></font><font color="#0000aa">let</font><font color="#000000"> num-turtles </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#0000aa">let</font><font color="#000000"> nnMatrix </font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#963700">0</font><font color="#000000">]]                </font><font color="#5a5a5a">;; Initialize matrix with zeros</font><font color="#000000"><br /></font><font color="#0000aa">let</font><font color="#000000"> id-list </font><font color="#660096">sort</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">                                           </font><font color="#5a5a5a">;; Get sorted list of turtle IDs</font><font color="#000000"><br /></font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />  </font><font color="#0000aa">let</font><font color="#000000"> my-index </font><font color="#660096">position</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> id-list                                         </font><font color="#5a5a5a">;; Find the index of this turtle in the sorted list</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> [<br />    </font><font color="#0000aa">let</font><font color="#000000"> neighbor-index </font><font color="#660096">position</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000">  id-list                                </font><font color="#5a5a5a">;; For each linked neighbor</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> new-row </font><font color="#660096">replace-item</font><font color="#000000"> neighbor-index </font><font color="#660096">item</font><font color="#000000"> my-index nnMatrix </font><font color="#963700">1</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> nnMatrix </font><font color="#660096">replace-item</font><font color="#000000"> my-index nnMatrix new-row<br />  ]<br />]<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;nnMatrix.txt&quot;</font><font color="#000000">                                                  </font><font color="#5a5a5a">;; Export matrix to file</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> nnMatrix [<br />    row -&gt; </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> (</font><font color="#660096">sentence</font><font color="#000000"> row) </font><font color="#963700">&quot; &quot;</font><font color="#000000">)<br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> network-matrix<br />  </font><font color="#0000aa">let</font><font color="#000000"> num-turtles </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> network_matrix </font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#660096">n-values</font><font color="#000000"> num-turtles [</font><font color="#963700">0</font><font color="#000000">]]         </font><font color="#5a5a5a">;; Initialize a square matrix filled with 0s.</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> turtle-list </font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">                                               </font><font color="#5a5a5a">;; Sort turtles to ensure consistent ordering.</font><font color="#000000"><br />                                                                             </font><font color="#5a5a5a">;; Iterate over all turtles to fill the matrix based on links.</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> turtle-list [<br />    source -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> source-index </font><font color="#660096">position</font><font color="#000000"> source turtle-list                             </font><font color="#5a5a5a">;; Find the index of the source turtle.</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> source [<br />      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> [<br />        </font><font color="#0000aa">let</font><font color="#000000"> target </font><font color="#660096">self</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> target-index </font><font color="#660096">position</font><font color="#000000"> target turtle-list                         </font><font color="#5a5a5a">;; Find the index of the target turtle.</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> network_matrix </font><font color="#660096">replace-item</font><font color="#000000"> source-index network_matrix (</font><font color="#660096">replace-item</font><font color="#000000"> target-index (</font><font color="#660096">item</font><font color="#000000"> source-index network_matrix) </font><font color="#963700">1</font><font color="#000000">) </font><font color="#5a5a5a">; Mark the link.</font><font color="#000000"><br />      ]<br />    ]<br />  ]<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;network_matrix.txt&quot;</font><font color="#000000">                                            </font><font color="#5a5a5a">;; Open the file for writing</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> network_matrix [                                                  </font><font color="#5a5a5a">;; Write each row of the matrix to the file</font><font color="#000000"><br />    row -&gt; </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> (</font><font color="#660096">sentence</font><font color="#000000"> row </font><font color="#963700">&quot; &quot;</font><font color="#000000">))                             </font><font color="#5a5a5a">;; Convert list to space-separated string</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000">                                                                </font><font color="#5a5a5a">;; Ensure the file is properly closed</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> nodeData<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;nodes.csv&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> sorted-turtles </font><font color="#660096">sort-on</font><font color="#000000"> [</font><font color="#660096">who</font><font color="#000000">] </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> sorted-turtles [ x -&gt;<br />    </font><font color="#0000aa">ask</font><font color="#000000"> x [                                                                 </font><font color="#5a5a5a">;; Determine the turtle's species type</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> spType </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species0) [</font><font color="#963700">&quot;ilex&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species1) [</font><font color="#963700">&quot;Toona&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species2) [</font><font color="#963700">&quot;Cana&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species3) [</font><font color="#963700">&quot;La&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species4) [</font><font color="#963700">&quot;Pet&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species5) [</font><font color="#963700">&quot;An&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species6) [</font><font color="#963700">&quot;Ar&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species7) [</font><font color="#963700">&quot;Gu&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species8) [</font><font color="#963700">&quot;Gr&quot;</font><font color="#000000">]<br />               (</font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species9) [</font><font color="#963700">&quot;Ki&quot;</font><font color="#000000">]<br />               )))))))))<br />    </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> spType)       ]              </font><font color="#5a5a5a">;; Print the turtle's data to the CSV file</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> linkData<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> </font><font color="#963700">&quot;links.csv&quot;</font><font color="#000000">                                                     </font><font color="#5a5a5a">;; Collect all links into a list, then sort by the who number of end1 and then end2</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> all-links [</font><font color="#660096">self</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> sorted-links </font><font color="#660096">sort</font><font color="#000000"> all-links<br />  </font><font color="#0000aa">foreach</font><font color="#000000"> sorted-links [ x -&gt;                                               </font><font color="#5a5a5a">;; Ask each link in the sorted list to print its ends' who numbers</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> x [<br />      </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000">  </font><font color="#660096">end1</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000">  </font><font color="#660096">end2</font><font color="#000000">)<br />    ]<br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> set-soil-factor<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">      [<br />      </font><font color="#0000aa">ifelse</font><font color="#000000">  soil </font><font color="#660096">=</font><font color="#000000"> soil1 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor  </font><font color="#963700">1.12</font><font color="#000000">   ]<br />      [</font><font color="#0000aa">ifelse</font><font color="#000000"> soil </font><font color="#660096">=</font><font color="#000000"> soil2 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">1.0</font><font color="#000000"> ]<br />      [</font><font color="#0000aa">ifelse</font><font color="#000000"> soil </font><font color="#660096">=</font><font color="#000000"> soil3 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">0.95</font><font color="#000000"> ]<br />      [</font><font color="#0000aa">ifelse</font><font color="#000000"> soil </font><font color="#660096">=</font><font color="#000000"> soil4 [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">0.85</font><font color="#000000"> ]<br />                           [ </font><font color="#0000aa">set</font><font color="#000000"> soil-factor </font><font color="#963700">0.80</font><font color="#000000"> ]<br />          ]<br />        ]<br />      ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> energy-account<br />  </font><font color="#0000aa">set</font><font color="#000000"> N  </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">                                   </font><font color="#5a5a5a">;; the number of patches will be used to obtain averages</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> start? [<br />        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">  [ </font><font color="#0000aa">set</font><font color="#000000"> soil-energy soil  ]           </font><font color="#5a5a5a">;; It is a duplicate that facilitates operations: growth, crop, trimming, fertilization which are operationalized for each soil type</font><font color="#000000"><br />        </font><font color="#0000aa">set</font><font color="#000000"> start? </font><font color="#963700">false</font><font color="#000000">                                 </font><font color="#5a5a5a">;; scaling soil type to growth energy; more fertility more energy given to plants in energy-trees</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />      [ </font><font color="#0000aa">set</font><font color="#000000"> et </font><font color="#963700">2.5</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> soil-factor<br />  ]<br />    </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> species-name (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> i)<br />    </font><font color="#0000aa">let</font><font color="#000000"> energy-var (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;energy-&quot;</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> i [</font><font color="#963700">&quot;ilex&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Cañafístola&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Lapacho&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Petiribí&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Anchico&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Araucaria&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Guatambú&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Grevillea&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Kiri&quot;</font><font color="#000000">]))<br />    </font><font color="#0000aa">ask</font><font color="#000000"> (</font><font color="#660096">turtle-set</font><font color="#000000"> </font><font color="#660096">runresult</font><font color="#000000"> species-name) [<br />      </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set &quot;</font><font color="#000000"> energy-var </font><font color="#963700">&quot; 1 * et&quot;</font><font color="#000000">)             </font><font color="#5a5a5a">;; each species will obtain a species-specific amount of energy; here the scaling is 1</font><font color="#000000"><br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> grow<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [ recalibrate-ilex-growth  growth-rate-ilex]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species1 [ grow-at-rate growth-rate-toona ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species2 [ grow-at-rate growth-rate-cana ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species3 [ grow-at-rate growth-rate-la ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species4 [ grow-at-rate growth-rate-pet ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species5 [ grow-at-rate growth-rate-an ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species6 [ grow-at-rate growth-rate-ar ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species7 [ grow-at-rate growth-rate-gu ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species8 [ grow-at-rate growth-rate-gr ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species9 [ grow-at-rate growth-rate-ki ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> growth-energy-uptake ( et </font><font color="#660096">*</font><font color="#000000"> Ni </font><font color="#660096">+</font><font color="#000000"> et </font><font color="#660096">*</font><font color="#000000"> Nt ) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> soil-energy   soil-energy </font><font color="#660096">-</font><font color="#000000"> growth-energy-uptake]<br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species0 turtles Growing :&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br />   </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species1 turtles Growing:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species1 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> recalibrate-ilex-growth [rate]<br />  </font><font color="#0000aa">let</font><font color="#000000"> combined-soil-factor soil-factor </font><font color="#660096">*</font><font color="#000000"> [local-soil-factor] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-here</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (((</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> rate) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)) </font><font color="#660096">*</font><font color="#000000"> combined-soil-factor)<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> grow-at-rate [rate]<br />  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (((</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> rate ) </font><font color="#660096">^</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">) ) </font><font color="#660096">*</font><font color="#000000"> soil-factor)<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> system-growth-energy-uptake<br /></font><font color="#0000aa">report</font><font color="#000000"> growth-energy-uptake<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> compete-shade<br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [                                                               </font><font color="#5a5a5a">;; Create an agentset of all other species</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> tree-agentset (</font><font color="#660096">turtle-set</font><font color="#000000"> tree-set)                                    </font><font color="#5a5a5a">;; Find neighbors within a radius of 7.5, excluding self</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> nearby-neighbors tree-agentset </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">7.5</font><font color="#000000">                           </font><font color="#5a5a5a">;; Find up to 4 closest neighbors from those within radius 7.5</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> closest-neighbors </font><font color="#660096">ifelse-value</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> nearby-neighbors </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">)<br />      [ </font><font color="#660096">min-n-of</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> nearby-neighbors [</font><font color="#660096">distance</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">] ]<br />      [ nearby-neighbors ]                                                     </font><font color="#5a5a5a">;; If fewer than 4 neighbors within radius 7.5, use all of them</font><font color="#000000"><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> closest-neighbors [                                                </font><font color="#5a5a5a">;; Only proceed if there are any close neighbors</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> avg-size </font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> closest-neighbors                              </font><font color="#5a5a5a">;; Calculate the average size of these closest neighbors</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> shade-factor </font><font color="#660096">max</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> (avg-size </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">30</font><font color="#000000">) </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)  </font><font color="#963700">0.7</font><font color="#000000">)                 </font><font color="#5a5a5a">;; Ensure shade doesn't reduce growth by more than 70%</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> avg-size </font><font color="#660096">&gt;</font><font color="#000000"> tree-thin-size [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> shade-factor             </font><font color="#5a5a5a">;; Reduce size if average size is greater than 9, same size that triggers thinning</font><font color="#000000"><br />      ]<br />      [<br />        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">9</font><font color="#000000"> [ </font><font color="#0000aa">stop</font><font color="#000000">                                                     </font><font color="#5a5a5a">;; normal increase in size if less than 9</font><font color="#000000"><br />        ]<br />      ]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;; Harvest of ilex per species of consociated tree</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> harvest-ilex<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Harvest-ilex called&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species0 turtles before harvest:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;harvest_per_plant.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> filename<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;tick,who,harvested,total_neighbors,species1_neighbors,species2_neighbors,species3_neighbors,species4_neighbors,species5_neighbors,species6_neighbors,species7_neighbors,species8_neighbors,species9_neighbors&quot;</font><font color="#000000"><br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> individual-harvest </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size [<br />      </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />      ]<br /><br />      </font><font color="#0000aa">set</font><font color="#000000"> individual-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />      </font><font color="#0000aa">set</font><font color="#000000"> harvest-amount </font><font color="#660096">lput</font><font color="#000000"> individual-harvest harvest-amount<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> local-harvest-rate)<br />      </font><font color="#0000aa">set</font><font color="#000000"> energy-ilex (energy-ilex </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1.25</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate </font><font color="#660096">*</font><font color="#000000"> et)<br />      </font><font color="#0000aa">set</font><font color="#000000"> total-harvest (</font><font color="#660096">sum</font><font color="#000000"> harvest-amount)<br />      </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-mate ((</font><font color="#660096">sum</font><font color="#000000"> harvest-amount </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.75</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> convert-dry </font><font color="#660096">*</font><font color="#000000"> convert-SOM)<br /><br />      </font><font color="#5a5a5a">;; Count neighbors by species type</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> total-neighbors </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> species1-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species1])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species2-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species2])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species3-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species3])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species4-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species4])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species5-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species5])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species6-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species6])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species7-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species7])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species8-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species8])<br />      </font><font color="#0000aa">let</font><font color="#000000"> species9-neighbors </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species9])<br /><br />      </font><font color="#5a5a5a">;; Export each turtle's record to CSV with neighbor breakdown</font><font color="#000000"><br />      </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> individual-harvest </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      total-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species1-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species2-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species3-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species4-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species5-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species6-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species7-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> species8-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                      species9-neighbors)<br />    ]<br />  ]<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; Create analysis summary</font><font color="#000000"><br />  create-harvest-by-species-analysis<br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;tick &quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot; total harvest: &quot;</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> harvest-amount)<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species0 turtles after harvest:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species0 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;sum harvest-amount : &quot;</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> harvest-amount)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-mate-Increment: &quot;</font><font color="#000000"> soil-multiplier-mate)<br />  update-soil-multipliers-mate soil-multiplier-mate<br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> create-harvest-by-species-analysis<br />  </font><font color="#0000aa">let</font><font color="#000000"> analysis-filename (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;harvest_analysis_by_species_&quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;.csv&quot;</font><font color="#000000">)<br />  </font><font color="#0000aa">file-open</font><font color="#000000"> analysis-filename<br />  </font><font color="#0000aa">file-print</font><font color="#000000"> </font><font color="#963700">&quot;neighbor_species,total_harvest,avg_harvest_per_plant,num_plants,avg_neighbors_per_plant&quot;</font><font color="#000000"><br /><br />  </font><font color="#5a5a5a">;; Analyze harvest for plants with each species neighbor type</font><font color="#000000"><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> species-breed </font><font color="#660096">runresult</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> i)<br />    </font><font color="#0000aa">let</font><font color="#000000"> ilex-with-this-neighbor species0 </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species-breed]]<br /><br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> ilex-with-this-neighbor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />      </font><font color="#5a5a5a">;; Only include plants that were actually harvested in this tick (size &gt;= harvest-size)</font><font color="#000000"><br />      </font><font color="#0000aa">let</font><font color="#000000"> harvested-ilex-with-this-neighbor ilex-with-this-neighbor </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size]<br /><br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-with-this-neighbor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />        </font><font color="#5a5a5a">;; Calculate harvest for each plant in this group (same formula as in harvest-ilex)</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> total-harvest-this-species </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> harvest-count </font><font color="#963700">0</font><font color="#000000"><br /><br />        </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-with-this-neighbor [<br />          </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />          </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />            </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />          ]<br />          </font><font color="#0000aa">let</font><font color="#000000"> this-plant-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />          </font><font color="#0000aa">set</font><font color="#000000"> total-harvest-this-species total-harvest-this-species </font><font color="#660096">+</font><font color="#000000"> this-plant-harvest<br />          </font><font color="#0000aa">set</font><font color="#000000"> harvest-count harvest-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />        ]<br /><br />        </font><font color="#5a5a5a">;; Calculate statistics for this group</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> avg-harvest-this-species total-harvest-this-species </font><font color="#660096">/</font><font color="#000000"> harvest-count<br />        </font><font color="#0000aa">let</font><font color="#000000"> num-plants-this-species </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-with-this-neighbor<br /><br />        </font><font color="#5a5a5a">;; Calculate average neighbors of this species type</font><font color="#000000"><br />        </font><font color="#0000aa">let</font><font color="#000000"> total-neighbors-count </font><font color="#963700">0</font><font color="#000000"><br />        </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-with-this-neighbor [<br />          </font><font color="#0000aa">set</font><font color="#000000"> total-neighbors-count total-neighbors-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> species-breed])<br />        ]<br />        </font><font color="#0000aa">let</font><font color="#000000"> avg-neighbors-this-species total-neighbors-count </font><font color="#660096">/</font><font color="#000000"> num-plants-this-species<br /><br />        </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> i </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> total-harvest-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                        avg-harvest-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> num-plants-this-species </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> avg-neighbors-this-species)<br />      ]<br />    ]<br />  ]<br /><br />  </font><font color="#5a5a5a">;;; Also analyze ilex with no tree neighbors</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> ilex-no-neighbors species0 </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">]<br />  </font><font color="#0000aa">let</font><font color="#000000"> harvested-ilex-no-neighbors ilex-no-neighbors </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> harvest-size]<br /><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-no-neighbors </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#5a5a5a">;; Calculate harvest for no-neighbor plants</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> total-harvest-no-neighbors </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">let</font><font color="#000000"> harvest-count-no-neighbors </font><font color="#963700">0</font><font color="#000000"><br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> harvested-ilex-no-neighbors [<br />      </font><font color="#0000aa">let</font><font color="#000000"> local-harvest-rate harvest-rate<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">12</font><font color="#000000"> [<br />        </font><font color="#0000aa">set</font><font color="#000000"> local-harvest-rate harvest-rate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />      ]<br />      </font><font color="#0000aa">let</font><font color="#000000"> this-plant-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> harvest-rate<br />      </font><font color="#0000aa">set</font><font color="#000000"> total-harvest-no-neighbors total-harvest-no-neighbors </font><font color="#660096">+</font><font color="#000000"> this-plant-harvest<br />      </font><font color="#0000aa">set</font><font color="#000000"> harvest-count-no-neighbors harvest-count-no-neighbors </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    ]<br /><br />    </font><font color="#0000aa">let</font><font color="#000000"> avg-harvest-no-neighbors total-harvest-no-neighbors </font><font color="#660096">/</font><font color="#000000"> harvest-count-no-neighbors<br />    </font><font color="#0000aa">let</font><font color="#000000"> num-plants-no-neighbors </font><font color="#660096">count</font><font color="#000000"> harvested-ilex-no-neighbors<br /><br />    </font><font color="#0000aa">file-print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;no_tree_neighbors,&quot;</font><font color="#000000"> total-harvest-no-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"><br />                    avg-harvest-no-neighbors </font><font color="#963700">&quot;,&quot;</font><font color="#000000"> num-plants-no-neighbors </font><font color="#963700">&quot;,0&quot;</font><font color="#000000">)<br />  ]<br /><br />  </font><font color="#0000aa">file-close</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> update-soil-multipliers-mate [increment]<br />  </font><font color="#0000aa">let</font><font color="#000000"> old-soil-multiplier soil-multiplier<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier ( soil-multiplier </font><font color="#660096">+</font><font color="#000000"> increment )<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000">  soil-gain   increment ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000">  soil-energy ( soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain)]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;old-soil-multiplier: &quot;</font><font color="#000000"> old-soil-multiplier)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;new-soil-multiplier: &quot;</font><font color="#000000"> soil-multiplier)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-harvest-mate<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> total-harvest] </font><font color="#660096">of</font><font color="#000000"> species0<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> trim-trees<br />  </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species1 turtles before trim:&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species1 [<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br />  </font><font color="#0000aa">let</font><font color="#000000"> tree-harvest </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> species-multipliers table:make                                             </font><font color="#5a5a5a">;; Use a table to track multipliers per species</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> trim-factors [</font><font color="#963700">0.61</font><font color="#000000">  </font><font color="#963700">0.75</font><font color="#000000">  </font><font color="#963700">0.67</font><font color="#000000">  </font><font color="#963700">0.69</font><font color="#000000">  </font><font color="#963700">0.76</font><font color="#000000">  </font><font color="#963700">0.8</font><font color="#000000">  </font><font color="#963700">0.64</font><font color="#000000">  </font><font color="#963700">0.74</font><font color="#000000">  </font><font color="#963700">0.65</font><font color="#000000">]         </font><font color="#5a5a5a">;; The product of these factors with growth rates equals 1.</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> species-names [</font><font color="#963700">&quot;Toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Cañafístola&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Lapacho&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Petiribí&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Anchico&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Araucaria&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Guatambú&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Grevillea&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Kiri&quot;</font><font color="#000000">]<br /><br />  </font><font color="#0000aa">foreach</font><font color="#000000"> (</font><font color="#660096">range</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) [ i -&gt;<br />    </font><font color="#0000aa">let</font><font color="#000000"> breed-name (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;species&quot;</font><font color="#000000"> (i))<br />    </font><font color="#0000aa">let</font><font color="#000000"> species-name </font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) species-names<br />    </font><font color="#0000aa">let</font><font color="#000000"> trim-factor </font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) trim-factors<br />    </font><font color="#0000aa">let</font><font color="#000000"> multipliers-species-contribution </font><font color="#963700">0</font><font color="#000000"><br /><br />    </font><font color="#0000aa">ask</font><font color="#000000"> (</font><font color="#660096">turtle-set</font><font color="#000000"> </font><font color="#660096">runresult</font><font color="#000000"> breed-name) [<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> tree-trim-size [<br />      </font><font color="#0000aa">set</font><font color="#000000"> tree-harvest </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> trim-factor)<br />      </font><font color="#0000aa">set</font><font color="#000000"> harvest-trees   ( tree-harvest)<br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> trim-factor<br />      </font><font color="#0000aa">let</font><font color="#000000"> current-energy </font><font color="#660096">runresult</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;energy-&quot;</font><font color="#000000"> species-name)<br />      </font><font color="#0000aa">run</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;set energy-&quot;</font><font color="#000000"> species-name </font><font color="#963700">&quot; &quot;</font><font color="#000000"> (current-energy </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">0.3</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> et))<br />      </font><font color="#0000aa">set</font><font color="#000000"> multipliers-species-contribution  multipliers-species-contribution </font><font color="#660096">+</font><font color="#000000"> harvest-trees </font><font color="#660096">*</font><font color="#000000"> ( convert-dry </font><font color="#660096">*</font><font color="#000000"> convert-SOM )<br />      ]<br />        ]<br />     table:put species-multipliers species-name multipliers-species-contribution<br />    ]<br />   </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Table species-multipliers: &quot;</font><font color="#000000"> species-multipliers)<br />   </font><font color="#0000aa">let</font><font color="#000000"> total-increment-multipliers </font><font color="#660096">sum</font><font color="#000000"> table:values species-multipliers<br />   </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total-increment-multipliers sum: &quot;</font><font color="#000000"> total-increment-multipliers)<br />   update-soil-multipliers-trimm total-increment-multipliers<br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> update-soil-multipliers-trimm [increment]<br />  </font><font color="#0000aa">let</font><font color="#000000"> old-soil-multiplier soil-multiplier<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees  soil-multiplier-trees </font><font color="#660096">+</font><font color="#000000"> increment<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier ( soil-multiplier </font><font color="#660096">+</font><font color="#000000"> soil-multiplier-trees )<br />   </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-gain soil-multiplier-trees<br />    </font><font color="#0000aa">set</font><font color="#000000"> soil-energy ( soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain )<br />  ]<br /><br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Old multiplier: &quot;</font><font color="#000000"> old-soil-multiplier)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil-multiplier-trees Trim-Increment: &quot;</font><font color="#000000"> increment)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;New soil-multiplier: &quot;</font><font color="#000000"> soil-multiplier)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil gain: &quot;</font><font color="#000000"> soil-gain)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Average soil gain: &quot;</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-gain] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> fertilize<br />  </font><font color="#0000aa">let</font><font color="#000000"> fertilizers-solubility  soil-multiplier </font><font color="#660096">*</font><font color="#000000"> buffer-factor<br />  </font><font color="#0000aa">set</font><font color="#000000">  fertilizer-amount  ( reposition </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> ) </font><font color="#660096">*</font><font color="#000000"> growth-energy-uptake </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">        </font><font color="#5a5a5a">;; percentage of tree consumption that is externally supplied</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-gain fertilizer-amount </font><font color="#660096">*</font><font color="#000000"> ( </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> fertilizers-solubility)            </font><font color="#5a5a5a">;; the external imput is leveraged by the multipliers</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> soil-energy  ( soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain ) ]                   </font><font color="#5a5a5a">;; soil-energy is incrased by the gain from the direct</font><font color="#000000"><br />  print-harvest-fertilizer-stats                                                 </font><font color="#5a5a5a">;; energy multipliers contribution, the external imput, and the multipliers on the external imput</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> print-harvest-fertilizer-stats<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> total-harvest </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">let</font><font color="#000000"> ratio ( fertilizer-amount </font><font color="#660096">/</font><font color="#000000"> total-harvest )<br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;fertilizer-harvest-ratio: &quot;</font><font color="#000000"> ratio )<br />  ]<br />    [ </font><font color="#0000aa">let</font><font color="#000000"> ratio </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;fertilizer-harvest-ratio: &quot;</font><font color="#000000"> ratio )<br />  ]<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Total harvest: &quot;</font><font color="#000000"> total-harvest )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Growth Energy Uptake: &quot;</font><font color="#000000"> growth-energy-uptake )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-for-fertilizer-amount: &quot;</font><font color="#000000"> soil-multiplier )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-energy: &quot;</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">)<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Fertilizer amount: &quot;</font><font color="#000000"> fertilizer-amount )<br />  </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Fertilizer-Harvest Ratio: &quot;</font><font color="#000000"> fertilizer-harvest-ratio)<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> perform-thinning [ycor-list]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> tree-thin-size </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">ycor</font><font color="#000000"> ycor-list [<br />      thin-tree<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> thin-tree<br />      </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;Sizes of three species1 turtles before thinning:&quot;</font><font color="#000000"><br />         </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">up-to-n-of</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> species1 [<br />           </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Turtle &quot;</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#963700">&quot;: size = &quot;</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000">)<br />  ]<br />      </font><font color="#0000aa">let</font><font color="#000000"> original-size </font><font color="#660096">size</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> thinned-amount ( original-size </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1.5</font><font color="#000000"> )<br />      </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-increment  thinned-amount </font><font color="#660096">*</font><font color="#000000"> convert-dry </font><font color="#660096">*</font><font color="#000000"> convert-SOM        </font><font color="#5a5a5a">;; approx 9-10 % of the harvest becomes dry matter, then 30% soil organic matter</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> thinned-count thinned-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-radius</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor local-soil-factor </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">0.12</font><font color="#000000">                                   </font><font color="#5a5a5a">;; Increase local-soil-factor by 10%</font><font color="#000000"><br />  ]<br />      </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees soil-multiplier-trees </font><font color="#660096">+</font><font color="#000000"> soil-multiplier-increment<br />      </font><font color="#0000aa">set</font><font color="#000000"> soil-gain soil-multiplier-increment<br />      </font><font color="#0000aa">set</font><font color="#000000"> soil-energy ( soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain )<br /><br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;thinned-count : &quot;</font><font color="#000000"> thinned-count )<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-trees Thin-Increment: &quot;</font><font color="#000000"> soil-multiplier-increment)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-multiplier-trees: &quot;</font><font color="#000000"> soil-multiplier-trees)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-gain: &quot;</font><font color="#000000"> soil-gain)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;soil-energy: &quot;</font><font color="#000000"> soil-energy)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;local-soil-factor: &quot;</font><font color="#000000"> local-soil-factor)<br /><br /><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> thinning1<br />  </font><font color="#0000aa">if</font><font color="#000000"> thiniter1? [<br />    perform-thinning [</font><font color="#963700">5</font><font color="#000000"> </font><font color="#963700">25</font><font color="#000000"> </font><font color="#963700">45</font><font color="#000000"> </font><font color="#963700">65</font><font color="#000000"> </font><font color="#963700">85</font><font color="#000000"> </font><font color="#963700">105</font><font color="#000000"> </font><font color="#963700">125</font><font color="#000000"> </font><font color="#963700">145</font><font color="#000000"> </font><font color="#963700">165</font><font color="#000000"> </font><font color="#963700">185</font><font color="#000000"> </font><font color="#963700">205</font><font color="#000000">]<br />    </font><font color="#0000aa">set</font><font color="#000000"> countert1 </font><font color="#660096">ticks</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thinned-count </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter1? </font><font color="#963700">false</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter2? </font><font color="#963700">true</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> thinning2<br />  </font><font color="#0000aa">if</font><font color="#000000"> thiniter2? [<br />    perform-thinning [</font><font color="#963700">15</font><font color="#000000"> </font><font color="#963700">35</font><font color="#000000"> </font><font color="#963700">55</font><font color="#000000"> </font><font color="#963700">75</font><font color="#000000"> </font><font color="#963700">95</font><font color="#000000"> </font><font color="#963700">115</font><font color="#000000"> </font><font color="#963700">135</font><font color="#000000"> </font><font color="#963700">155</font><font color="#000000"> </font><font color="#963700">175</font><font color="#000000"> </font><font color="#963700">195</font><font color="#000000"> </font><font color="#963700">215</font><font color="#000000">]<br />    </font><font color="#0000aa">set</font><font color="#000000"> thinned-count </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter1? </font><font color="#963700">true</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> thiniter2? </font><font color="#963700">false</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> cumulative-thinning-effect<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier-trees] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> update-soil-multipliers [increment]<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees  increment<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier soil-multiplier </font><font color="#660096">+</font><font color="#000000"> soil-multiplier-trees<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> soil-gain  soil-multiplier-trees </font><font color="#660096">*</font><font color="#000000"> thinned-count ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> soil-energy (soil-energy </font><font color="#660096">+</font><font color="#000000"> soil-gain)]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> current-soil-gain<br />  </font><font color="#0000aa">report</font><font color="#000000"> soil-gain<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> current-soil-energy<br />  </font><font color="#0000aa">report</font><font color="#000000"> soil-energy<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> decay-local-soil-factor<br />  </font><font color="#0000aa">let</font><font color="#000000"> decay-rate </font><font color="#963700">0.0268</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> time-rebalance ( </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> last-rebalance ) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> last-rebalance  </font><font color="#660096">ticks</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> previous-soil-energy </font><font color="#660096">mean</font><font color="#000000"> [soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor local-soil-factor </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)      </font><font color="#5a5a5a">;; Adjust this value as needed</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor </font><font color="#963700">1</font><font color="#000000">]<br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> rebalance-soil<br />  </font><font color="#0000aa">let</font><font color="#000000"> decay-rate </font><font color="#963700">0.0268</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> time-rebalance ( </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> last-rebalance ) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">write</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;time-rebalance:&quot;</font><font color="#000000"> time-rebalance)<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> current </font><font color="#660096">mean</font><font color="#000000"> [soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> previous-soil-energy </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [  </font><font color="#0000aa">set</font><font color="#000000"> soil-energy-improvement (current </font><font color="#660096">/</font><font color="#000000"> previous-soil-energy) ]<br />  [   ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> minreposition? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">True</font><font color="#000000"> [<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> soil-energy-improvement </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1.44</font><font color="#000000"> [                                                 </font><font color="#5a5a5a">;; If improvement is greater than 20%</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> reposition </font><font color="#660096">max</font><font color="#000000"> ( </font><font color="#660096">list</font><font color="#000000"> (reposition </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">0.6</font><font color="#000000"> ) </font><font color="#963700">10</font><font color="#000000"> )                                  </font><font color="#5a5a5a">;; Reduce by 20% but not below 10%</font><font color="#000000"><br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil improvement: &quot;</font><font color="#000000"> </font><font color="#660096">precision</font><font color="#000000"> ((soil-energy-improvement </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">) </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Reducing reposition to: &quot;</font><font color="#000000"> reposition </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br />  ]<br />     [</font><font color="#0000aa">if</font><font color="#000000"> soil-energy-improvement </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [                                                    </font><font color="#5a5a5a">;; If improvement is greater than 25%</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> reposition  </font><font color="#660096">min</font><font color="#000000"> ( </font><font color="#660096">list</font><font color="#000000"> (reposition </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">1.20</font><font color="#000000"> ) </font><font color="#963700">200</font><font color="#000000">  )] ]                           </font><font color="#5a5a5a">;;</font><font color="#000000"><br /><br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Soil improvement: &quot;</font><font color="#000000"> </font><font color="#660096">precision</font><font color="#000000"> ((soil-energy-improvement </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">) </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br />      </font><font color="#0000aa">print</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Reducing reposition to: &quot;</font><font color="#000000"> reposition </font><font color="#963700">&quot;%&quot;</font><font color="#000000">)<br /><br />  ]<br /><br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier soil-multiplier </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-mate soil-multiplier-mate </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)<br />  </font><font color="#0000aa">set</font><font color="#000000"> soil-multiplier-trees soil-multiplier-trees </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate </font><font color="#660096">*</font><font color="#000000"> time-rebalance)<br /><br />  </font><font color="#0000aa">set</font><font color="#000000"> last-rebalance  </font><font color="#660096">ticks</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [<br />      </font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor local-soil-factor </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">exp</font><font color="#000000">(</font><font color="#660096">-</font><font color="#000000"> decay-rate  </font><font color="#660096">*</font><font color="#000000"> time-rebalance)     </font><font color="#5a5a5a">;; Adjust this value as needed</font><font color="#000000"><br />      </font><font color="#0000aa">if</font><font color="#000000"> local-soil-factor </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> local-soil-factor </font><font color="#963700">1</font><font color="#000000">]<br />    ]<br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> soil current-soil-energy ]                                           </font><font color="#5a5a5a">;; the soil type changes and the colors change to map this continuously</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  [ </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil<br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">49</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil1 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil </font><font color="#660096">and</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">8000</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">39</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil2 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil </font><font color="#660096">and</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">6000</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">29</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil3 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> soil </font><font color="#660096">and</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">4000</font><font color="#000000"><br />    [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">    </font><font color="#963700">19</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil4 soil ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> soil </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">2000</font><font color="#000000"><br />   [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000">  </font><font color="#963700">139</font><font color="#000000"><br />     </font><font color="#0000aa">set</font><font color="#000000"> soil5 soil ]<br />  ]<br /> </font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> die-ilex<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> minimum-viable-size [</font><font color="#0000aa">die</font><font color="#000000">]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> die-tree<br /></font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> minimum-viable-size [</font><font color="#0000aa">die</font><font color="#000000">]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> current-energy-plants<br />  </font><font color="#0000aa">report</font><font color="#000000">  </font><font color="#660096">mean</font><font color="#000000"> [ et ] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-multiplier-mate<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-multiplier-mate] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> all-soil-multiplier-mate<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-multiplier-mate </font><font color="#660096">*</font><font color="#000000"> Ni] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-multiplier-trees<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-multiplier-trees] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> all-soil-multiplier-trees<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-multiplier-trees </font><font color="#660096">*</font><font color="#000000"> Nt] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-multiplier<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-multiplier] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> thinning-biomass-removed<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [thinned-amount] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-biomass-removed<br />  </font><font color="#0000aa">report</font><font color="#000000"> total-harvest </font><font color="#660096">+</font><font color="#000000"><br />         </font><font color="#660096">sum</font><font color="#000000"> [harvest-trees] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">breed</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> species0]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;; The following reporters are useful for modifications and debugging but otherwise can be deleted</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> soil-multiplier-sources<br />  </font><font color="#0000aa">let</font><font color="#000000"> report-string </font><font color="#963700">&quot;&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> report-string (</font><font color="#660096">word</font><font color="#000000"> report-string<br />    </font><font color="#963700">&quot;Harvest contributions: &quot;</font><font color="#000000"> soil-multiplier-mate </font><font color="#963700">&quot;\n&quot;</font><font color="#000000"><br />    </font><font color="#963700">&quot;Trimming contributions: &quot;</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> table:values species-multipliers </font><font color="#963700">&quot;\n&quot;</font><font color="#000000"><br />    </font><font color="#963700">&quot;Thinning contributions: &quot;</font><font color="#000000"> soil-multiplier-increment </font><font color="#963700">&quot;\n&quot;</font><font color="#000000"><br />    </font><font color="#963700">&quot;Current total multiplier: &quot;</font><font color="#000000"> soil-multiplier </font><font color="#963700">&quot;\n&quot;</font><font color="#000000"><br />    </font><font color="#963700">&quot;Average soil gain: &quot;</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [soil-gain] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000">)<br />  </font><font color="#0000aa">report</font><font color="#000000"> report-string<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> species-contributions<br />  </font><font color="#0000aa">let</font><font color="#000000"> contributions table:to-list species-multipliers<br />  </font><font color="#0000aa">let</font><font color="#000000"> species-names [</font><font color="#963700">&quot;Toona&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Cañafístola&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Lapacho&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Petiribí&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Anchico&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Araucaria&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Guatambú&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Grevillea&quot;</font><font color="#000000"> </font><font color="#963700">&quot;Kiri&quot;</font><font color="#000000">]<br />  </font><font color="#0000aa">let</font><font color="#000000"> report-string </font><font color="#963700">&quot;&quot;</font><font color="#000000"><br />  (</font><font color="#0000aa">foreach</font><font color="#000000"> species-names contributions [ [sp cont] -&gt;<br />    </font><font color="#0000aa">set</font><font color="#000000"> report-string (</font><font color="#660096">word</font><font color="#000000"> report-string sp </font><font color="#963700">&quot;: &quot;</font><font color="#000000"> cont </font><font color="#963700">&quot;\n&quot;</font><font color="#000000">)<br />  ])<br />  </font><font color="#0000aa">report</font><font color="#000000"> report-string<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> external-reposition<br />  </font><font color="#0000aa">report</font><font color="#000000"> fertilizer-amount<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> fertilizer-harvest-ratio<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> total-harvest </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [<br />    </font><font color="#0000aa">report</font><font color="#000000"> fertilizer-amount </font><font color="#660096">/</font><font color="#000000"> total-harvest<br />  ] [<br />    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-gain<br />  </font><font color="#0000aa">report</font><font color="#000000">  [</font><font color="#660096">round</font><font color="#000000"> soil-gain] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil-energy<br />  </font><font color="#0000aa">report</font><font color="#000000">  </font><font color="#660096">mean</font><font color="#000000"> [ soil-energy] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-soil<br />  </font><font color="#0000aa">report</font><font color="#000000">  </font><font color="#660096">mean</font><font color="#000000"> [ soil] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-energy-ilex<br />  </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-ilex] </font><font color="#660096">of</font><font color="#000000"> species0<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> avg-energy-ilex<br />  </font><font color="#0000aa">report</font><font color="#000000"> total-energy-ilex </font><font color="#660096">/</font><font color="#000000"> Ni<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> total-energy-trees<br />  </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">sum</font><font color="#000000"> [energy-Toona] </font><font color="#660096">of</font><font color="#000000"> species1 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Cañafístola] </font><font color="#660096">of</font><font color="#000000"> species2 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Lapacho] </font><font color="#660096">of</font><font color="#000000"> species3 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Petiribí] </font><font color="#660096">of</font><font color="#000000"> species4 </font><font color="#660096">+</font><font color="#000000"><br />    </font><font color="#660096">sum</font><font color="#000000"> [energy-Anchico] </font><font color="#660096">of</font><font color="#000000"> species5 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Araucaria] </font><font color="#660096">of</font><font color="#000000"> species6 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Guatambú] </font><font color="#660096">of</font><font color="#000000"> species7 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Grevillea] </font><font color="#660096">of</font><font color="#000000"> species8 </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">sum</font><font color="#000000"> [energy-Kiri] </font><font color="#660096">of</font><font color="#000000"> species9 )<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> avg-energy-trees<br />  </font><font color="#0000aa">report</font><font color="#000000"> total-energy-trees </font><font color="#660096">/</font><font color="#000000"> Nt<br /></font><font color="#007f69">end</font><font color="#000000"><br /></font>
</pre>
